===============================================================================
ğŸš€ INICIO RÃPIDO - BOT DE TELEGRAM
===============================================================================

OPCIÃ“N 1: IMPLEMENTACIÃ“N BÃSICA (15 minutos)
--------------------------------------------

PASO 1 - Crear el bot en Telegram
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. Abre Telegram y busca: @BotFather
2. EnvÃ­a: /newbot
3. Nombre: "Taller MecÃ¡nico Bot"
4. Username: "taller_mecanico_bot"
5. Copia el TOKEN que te da BotFather


PASO 2 - Instalar librerÃ­a
~~~~~~~~~~~~~~~~~~~~~~~~~~~
cd "/home/christian/proyecto Py/ProyectoTaller"
source abel_env/bin/activate
pip install python-telegram-bot==20.7


PASO 3 - Configurar token en settings.py
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Agregar al final de taller_mecanico/settings.py:

# Telegram Bot
TELEGRAM_BOT_TOKEN = 'TU_TOKEN_AQUI'


PASO 4 - Copiar archivo del bot
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cp ejemplo_telegram_bot.py taller_mecanico/gestion/telegram_bot.py


PASO 5 - Copiar script de ejecuciÃ³n
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
cp ejemplo_run_telegram_bot.py taller_mecanico/run_telegram_bot.py
chmod +x taller_mecanico/run_telegram_bot.py


PASO 6 - Ejecutar el bot
~~~~~~~~~~~~~~~~~~~~~~~~~
cd taller_mecanico
python run_telegram_bot.py


PASO 7 - Probar en Telegram
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. Busca tu bot en Telegram: @taller_mecanico_bot
2. EnvÃ­a: /start
3. Prueba: /estado ABC123 (con una placa real de tu BD)

âœ… Â¡LISTO! Tu bot estÃ¡ funcionando en modo desarrollo.


===============================================================================

OPCIÃ“N 2: IMPLEMENTACIÃ“N CON NOTIFICACIONES (30 minutos)
--------------------------------------------------------

Incluye todo lo anterior MÃS:

PASO 8 - Agregar campos al modelo Cliente
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
En gestion/models.py, clase Cliente, agregar:

    telegram_chat_id = models.CharField(
        max_length=50, blank=True, null=True,
        verbose_name='Telegram Chat ID'
    )


PASO 9 - Crear migraciÃ³n
~~~~~~~~~~~~~~~~~~~~~~~~~
python manage.py makemigrations
python manage.py migrate


PASO 10 - Crear seÃ±al para notificaciones
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Crear archivo: gestion/signals.py

from django.db.models.signals import post_save
from django.dispatch import receiver
from .models import Reparacion
import requests
from django.conf import settings

@receiver(post_save, sender=Reparacion)
def notificar_cambio_estado(sender, instance, created, **kwargs):
    if instance.estado_reparacion == 'completada' and instance.fecha_salida:
        cliente = instance.vehiculo.cliente
        if cliente.telegram_chat_id:
            mensaje = f"""
âœ… Â¡Tu vehÃ­culo estÃ¡ listo!

{instance.vehiculo.marca} {instance.vehiculo.modelo}
Placa: {instance.vehiculo.placa}

Puedes pasar a retirar tu vehÃ­culo.
            """
            url = f"https://api.telegram.org/bot{settings.TELEGRAM_BOT_TOKEN}/sendMessage"
            requests.post(url, json={
                'chat_id': cliente.telegram_chat_id,
                'text': mensaje
            })


PASO 11 - Registrar seÃ±ales en apps.py
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
En gestion/apps.py:

    def ready(self):
        import gestion.signals


PASO 12 - Vincular un cliente de prueba
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
En el admin de Django:
1. Editar un cliente
2. Agregar su telegram_chat_id (lo obtiene con /vincular en el bot)
3. Guardar


PASO 13 - Probar notificaciÃ³n
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. Marca una reparaciÃ³n como "completada"
2. El cliente deberÃ­a recibir notificaciÃ³n en Telegram

âœ… Â¡Bot con notificaciones funcionando!


===============================================================================

COMANDOS DISPONIBLES EN EL BOT:
-------------------------------

/start      - Iniciar el bot
/help       - Ver ayuda
/estado     - Consultar estado de reparaciÃ³n (ej: /estado ABC123)
/contacto   - Ver info del taller
/agendar    - Solicitar cita
/vincular   - Vincular cuenta de Telegram

TambiÃ©n puedes escribir directamente una placa sin comando.


===============================================================================

ESTRUCTURA DE ARCHIVOS:
-----------------------

proyecto/
â”œâ”€â”€ taller_mecanico/
â”‚   â”œâ”€â”€ gestion/
â”‚   â”‚   â”œâ”€â”€ telegram_bot.py          â† LÃ³gica del bot
â”‚   â”‚   â”œâ”€â”€ signals.py                â† Notificaciones automÃ¡ticas
â”‚   â”‚   â””â”€â”€ management/
â”‚   â”‚       â””â”€â”€ commands/
â”‚   â”‚           â””â”€â”€ vincular_telegram.py
â”‚   â”œâ”€â”€ run_telegram_bot.py           â† Script para ejecutar bot
â”‚   â”œâ”€â”€ settings.py                   â† ConfiguraciÃ³n
â”‚   â””â”€â”€ .env                          â† Variables de entorno
â””â”€â”€ GUIA_BOT_TELEGRAM.txt             â† Esta guÃ­a


===============================================================================

PRÃ“XIMOS PASOS RECOMENDADOS:
----------------------------

1. ğŸ“± Implementar comando /vincular para que clientes vinculen sus cuentas
2. ğŸ”” Agregar notificaciones para mÃ¡s eventos (inicio de reparaciÃ³n, etc)
3. ğŸ“Š Crear comando para ver estadÃ­sticas (mecÃ¡nicos)
4. ğŸ“… Implementar agendamiento completo vÃ­a bot
5. ğŸŒ Configurar webhook para producciÃ³n (en lugar de polling)
6. ğŸ”’ Agregar autenticaciÃ³n para comandos administrativos
7. ğŸ“ˆ Implementar analytics y logs de uso


===============================================================================

CASOS DE USO PRÃCTICOS:
-----------------------

âœ… Cliente consulta estado de su reparaciÃ³n 24/7
âœ… NotificaciÃ³n automÃ¡tica cuando vehÃ­culo estÃ¡ listo
âœ… Recordatorios de citas programadas
âœ… MecÃ¡nicos reciben notificaciÃ³n de nueva asignaciÃ³n
âœ… Alertas de tareas urgentes
âœ… ConfirmaciÃ³n de agendamiento de citas
âœ… Recordatorios de mantenimiento preventivo


===============================================================================

SOLUCIÃ“N DE PROBLEMAS:
---------------------

âŒ Error: "TELEGRAM_BOT_TOKEN not configured"
   âœ… Verifica que el token estÃ© en settings.py

âŒ Bot no responde
   âœ… Verifica que run_telegram_bot.py estÃ© ejecutÃ¡ndose
   âœ… Revisa la consola para ver errores

âŒ Error de permisos
   âœ… AsegÃºrate de que el bot tenga permisos para enviar mensajes

âŒ No recibe notificaciones
   âœ… Verifica que el cliente tenga telegram_chat_id guardado
   âœ… Verifica que las seÃ±ales estÃ©n registradas en apps.py


===============================================================================

RECURSOS ÃšTILES:
---------------

ğŸ“š DocumentaciÃ³n oficial:
   https://core.telegram.org/bots/api

ğŸ“š python-telegram-bot:
   https://docs.python-telegram-bot.org/

ğŸ“š Ejemplos:
   https://github.com/python-telegram-bot/python-telegram-bot/tree/master/examples

ğŸ’¬ Comunidad:
   https://t.me/pythontelegrambotgroup


===============================================================================

Â¿NECESITAS AYUDA?
-----------------

Si tienes problemas o preguntas, puedes:
1. Revisar los archivos de ejemplo
2. Consultar la documentaciÃ³n oficial
3. Revisar el cÃ³digo en telegram_bot.py
4. Activar modo debug para ver errores detallados


===============================================================================
FIN - Â¡Ã‰xito con tu bot! ğŸ¤–
===============================================================================
